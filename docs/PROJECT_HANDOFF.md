Project Handoff: Sofas & Stuff Voice Price Check Tool

1. Current Status

We have successfully built and deployed a Simple Prototype to prove our core architecture. The prototype is LIVE:

Frontend: https://sameercodes28.github.io/S-S/ (using index.html)

Backend: https://us-central1-sofaproject-476903.cloudfunctions.net/sofa-prototype-api (using main.py)

The prototype successfully handles two hardcoded queries: "alwinton snuggler pacific" and "arles super king waves," proving our 2-API routing logic.

2. Next Goal: Upgrade to Full-Scale Application

We are now moving from the simple prototype to the full-scale tool. This involves:

Scraping: Running a Python script (sku_discovery_tool.py) to crawl the S&S website and generate four JSON data files (the "brain").

Replacing Backend: Overwriting the simple main.py on Google Cloud Functions with a new, full-scale main.py that reads from these JSON files.

3. Validated Core Logic: The 2-API Routing

Our most critical discovery is that S&S uses two different internal APIs for pricing. Our backend must act as a smart router.

Product Type

API Endpoint

Payload Format

Response

Sofa / Chair / Footstool / Dog Bed



Sofa Bed / Snuggler

/ProductExtend/ChangeProductSize

Combined SKU String



(e.g., querySku: "alwsnufitsxppac")

Nested JSON



(Includes HeroImages)

Bed

/Category/ProductPrice

Component SKU Parts



(e.g., productsku: "arl", sizesku: "skb"...)

Flat JSON



(No Images)

4. Project File Set (Full-Scale)

This project consists of 8 main files:

index.html (Frontend): The single-page web app. It uses webkitSpeechRecognition and has a text-input fallback. It makes a fetch call to the backend URL.

main.py (Full Backend): The new, full-scale Google Cloud Function. It does not use Flask as a server, only functions-framework. It:

Loads the 4 JSON "brain" files.

Includes request retries and a 5-min cache.

Parses the user's natural language query (e.g., "alwinton snuggler pacific").

Looks up the product type from products.json.

Routes to the correct API (Sofa vs. Bed) based on the type.

Builds the correct payload (Combined vs. Component).

Returns a simple, clean JSON response to the frontend.

requirements.txt (Backend Deps): functions-framework, requests, urllib3, flask (for jsonify only).

sku_discovery_tool.py (Scraper): A one-time-use Python script (run locally) that:

Scrapes all product categories to find all products, sizes, and covers.

Calls GetPDPFabrics for every product to get its unique fabric list.

Generates the four JSON files.

Uses fuzzywuzzy to clean up keywords.

Includes a session with retries.

requirements_scraper.txt (Scraper Deps): requests, beautifulsoup4, fuzzywuzzy, python-Levenshtein, urllib3.

products.json (DATA): Generated by the scraper. Maps keywords to product data.

"alwinton": {"sku": "alw", "type": "sofa", ...}

"arles": {"sku": "arl", "type": "bed", ...}

sizes.json (DATA): Generated by the scraper. Nested by product SKU.

"alw": {"snuggler": "snu", "3 seater": "3se", ...}

covers.json (DATA): Generated by the scraper. Nested by product SKU.

"alw": {"fitted": "fit", "loose": "lse"}

fabrics.json (DATA): Generated by the scraper. Nested by product SKU.

"alw": {"pacific": {"fabric_sku": "sxp", ...}, ...}